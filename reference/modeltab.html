<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function takes an occurrence dataset and reformats it to a table that can be used as input for logistic models."><title>Origination/extinction response table for statistical modelling. — modeltab • divDyn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Origination/extinction response table for statistical modelling. — modeltab"><meta property="og:description" content="This function takes an occurrence dataset and reformats it to a table that can be used as input for logistic models."><meta property="og:image" content="https://divDyn.github.io/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">divDyn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/divDyn_1_installation.html">1. Installation</a>
    <a class="dropdown-item" href="../articles/divDyn_2_handout.html">2. Handout</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-internals">Internals</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-internals">
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.evolv-ed.net/">How-to guides on EvolvED</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/divDyn/divDyn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Origination/extinction response table for statistical modelling.</h1>
      <small class="dont-index">Source: <a href="https://github.com/divDyn/divDyn/blob/HEAD/R/modeltab.R" class="external-link"><code>R/modeltab.R</code></a></small>
      <div class="d-none name"><code>modeltab.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes an occurrence dataset and reformats it to a table that can be used as input for logistic models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modeltab</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">tax</span>,</span>
<span>  <span class="va">bin</span>,</span>
<span>  taxvars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  singletons <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  probs <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>(data.frame)</code> Fossil occurrence data.frame.</p></dd>


<dt>tax</dt>
<dd><p><code>(character)</code> Variable name of the occurring taxa (variable type: <code>factor</code> or <code>character</code> - such as <code>"genus"</code>)</p></dd>


<dt>bin</dt>
<dd><p><code>(character)</code> Variable name of the bin numbers of the occurrences. This variable should be <code>numeric</code> and should increase as time passes by (use negative values for age estimates). The current version only supports discreet, non-negative integer interval numbers.</p></dd>


<dt>taxvars</dt>
<dd><p><code>(character)</code> Taxon-specific column names of the variables that should be included in the output table. Only one entry/taxon is used, make sure that the data are clean.</p></dd>


<dt>rt</dt>
<dd><p><code>(logical)</code> Should the range-through assumption be applied within the function? If set to <code>TRUE</code> then missing occurrences will be interpolated with <code>FALSE</code> values in both the <code>ext</code> and <code>ori</code> variables. .</p></dd>


<dt>singletons</dt>
<dd><p><code>(logical)</code> Should single-interval taxa be included from the final table? This is not recommended, as it is impossible to get a <code>FALSE</code> response for these taxa.</p></dd>


<dt>probs</dt>
<dd><p><code>(logical)</code> When set to <code>NULL</code>, the response variable will be binary. When set to <code>"samp3t"</code> or <code>"sampRange"</code> the response results will be probabilities, based on the three-timer sampling completeness, or the range-based sampling completeness, respectively.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data.frame with binary response variables.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Every entry in the output table corresponds to one cell in the <code>bin</code>/<code>tax</code> matrix. This function omits duplicates and concatenates two <code>logical</code> vectors (response variables) to the occurrence dataset:  
The <code>ori</code> vector is <code>TRUE</code> in the interval when the taxon first appeared, and <code>FALSE</code> in all others. The <code>ext</code> vector is <code>TRUE</code> in the interval the taxon appeared for the last time, and <code>FALSE</code> in the rest.</p>
<p>The true date of extinction and origination is unknown, therefore these events can only be expressed as probabilities. The argument <code>probs</code> allows the replacement of a binary response with two probability values, which are based on the apparent sampling patterns. For extinctions, when <code>probs</code> is set to <code>"samp3t"</code>, the response parameter for extinctions in the last bin of appearance is set to the three-timer sampling compelteness of the following bin. Assuming that the taxon'as range offset is not larger than a whole bin, if the taxon did not go extinct in the bin in which it appeared the last time, it is assumed to be going extinct in the following bin, and the remainder (1 -  sampling completeness) is assigned to that bin. The pattern is reversed for originations. For <code>probs="sampRange"</code>, the range-based completeness measures are applied in a similar fashion. For Phanerozoic-scale analyses, a whole bin difference between apparent event and the actual event is reasonable. See more in Reddin et al. 2021. Note that the response probabilities are set to missing values (<code>NA</code>s) when the probabilities cannot be calculated. The variable <code>ext</code> is also set to <code>NaN</code> for the early virtual extension of the range, and <code>ori</code> is treated the same for the late-extension.</p>
<p><strong>References:</strong></p>
<p>Reddin, C. J., Kocsis, Á. T., Aberhan, M., &amp; Kiessling, W. (2021). Victims of ancient hyperthermal events herald the fates of marine clades and traits under global warming. Global Change Biology, 27(4), 868–878. https://doi.org/10.1111/gcb.15434</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load necessary data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">corals</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># simple table</span></span></span>
<span class="r-in"><span><span class="va">modTab</span><span class="op">&lt;-</span><span class="fu">modeltab</span><span class="op">(</span><span class="va">corals</span>, bin<span class="op">=</span><span class="st">"stg"</span>, tax<span class="op">=</span><span class="st">"genus"</span>, taxvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ecology"</span>, <span class="st">"family"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># probabilities for extinction modeling</span></span></span>
<span class="r-in"><span><span class="va">modTab2</span> <span class="op">&lt;-</span> <span class="fu">modeltab</span><span class="op">(</span><span class="va">corals</span>, bin<span class="op">=</span><span class="st">"stg"</span>, tax<span class="op">=</span><span class="st">"genus"</span>, probs<span class="op">=</span><span class="st">"samp3t"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># only extinction response (omit virtual origination extensions)</span></span></span>
<span class="r-in"><span><span class="va">extTab</span> <span class="op">&lt;-</span> <span class="va">modTab2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">modTab2</span><span class="op">$</span><span class="va">ext</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># only extinction response (omit virtual extinction extensions)</span></span></span>
<span class="r-in"><span><span class="va">oriTab</span> <span class="op">&lt;-</span> <span class="va">modTab2</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">modTab2</span><span class="op">$</span><span class="va">ori</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a>, <a href="https://researchers.mq.edu.au/en/persons/john-alroy" class="external-link">John Alroy</a>, <a href="https://www.gzn.nat.fau.eu/palaeontologie/team/former-members/reddin/" class="external-link">Carl J. Reddin</a>, <a href="https://www.gzn.nat.fau.eu/palaeontologie/team/professors/kiessling/" class="external-link">Wolfgang Kiessling</a>, <a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://www.dfg.de/includes/bausteine/open_graph_de/dfgfallback.jpg" alt="dfg" width="80"></a>, <a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://www.gzn.nat.fau.de/files/2017/05/cropped-gzn-logo.jpg" alt="geozentrum" width="80"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

